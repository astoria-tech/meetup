---
import MainLayout from "../layouts/MainLayout.astro";
import { getCollection } from "astro:content";
import {
  Calendar,
  MessageCircle,
  Instagram,
  Github,
  PenTool,
} from "lucide-astro";

// Get the latest event
const events = await getCollection("events");
const sortedEvents = events.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime(),
);
const latestEvent = sortedEvents[0];

const links = [
  {
    name: "Meetup",
    href: "https://www.meetup.com/astoria-tech-meetup/",
    description: "RSVP to upcoming events",
    icon: Calendar,
  },
  {
    name: "Discord",
    href: "https://discord.gg/fSjneA8qwh",
    description: "Join our community chat",
    icon: MessageCircle,
  },
  {
    name: "Instagram",
    href: "https://www.instagram.com/astoria.tech/",
    description: "Follow us for updates and photos",
    icon: Instagram,
  },
  {
    name: "GitHub",
    href: "https://github.com/astoria-tech",
    description: "Contribute to our projects",
    icon: Github,
  },
  {
    name: "Community Posts",
    href: "https://astoria-tech.github.io/subcurrent-astro/",
    description: "Blog posts from our community members",
    icon: PenTool,
  },
];
---

<MainLayout title="Links - Astoria Tech Meetup">
  <!-- Page header -->
  <section class="mb-10">
    <div class="max-w-4xl">
      <h1 class="text-3xl font-bold text-emerald-900 mb-4">Community Links</h1>
      <p class="text-lg text-emerald-800 mb-6">
        Connect with us across different platforms and stay up to date with the
        latest from our tech community.
      </p>
    </div>
  </section>

  <!-- Links grid -->
  <section>
    <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
      <!-- Latest Event RSVP (featured) -->
      {
        latestEvent && latestEvent.data.meetup && (
          <a
            href={latestEvent.data.meetup}
            target="_blank"
            rel="noopener noreferrer"
            class="group bg-emerald-50 rounded-lg border-2 border-emerald-300 p-6 hover:shadow-md hover:border-emerald-400 transition-all duration-200"
          >
            <div class="flex items-center gap-3 mb-3">
              <Calendar class="w-6 h-6 text-emerald-700 group-hover:text-emerald-600 transition-colors duration-200 flex-shrink-0" />
              <h3 class="text-xl font-semibold text-emerald-900 group-hover:text-emerald-600 transition-colors duration-200">
                RSVP to Next Event
              </h3>
            </div>
            <p class="text-emerald-700 text-sm">
              {latestEvent.data.title} -{" "}
              {new Date(latestEvent.data.date).toLocaleDateString("en-US", {
                weekday: "long",
                month: "long",
                day: "numeric",
                timeZone: "America/New_York",
              })}
            </p>
          </a>
        )
      }

      <!-- Regular links -->
      {
        links.map((link) => (
          <a
            href={link.href}
            target="_blank"
            rel="noopener noreferrer"
            class="group bg-white rounded-lg border border-green-200 p-6 hover:shadow-md hover:border-emerald-300 transition-all duration-200"
          >
            <div class="flex items-center gap-3 mb-3">
              <link.icon class="w-6 h-6 text-emerald-700 group-hover:text-emerald-600 transition-colors duration-200 flex-shrink-0" />
              <h3 class="text-xl font-semibold text-emerald-900 group-hover:text-emerald-600 transition-colors duration-200">
                {link.name}
              </h3>
            </div>
            <p class="text-emerald-700 text-sm">{link.description}</p>
          </a>
        ))
      }
    </div>
  </section>
</MainLayout>
